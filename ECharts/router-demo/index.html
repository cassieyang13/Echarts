<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../echarts.js"></script>
    <script src="../jquery.min.js"></script>
</head>
<body>

<div id="wrap" style="width: 750px; height: 400px;">

</div>

<script>
    var json_data ={
        "Upload":
                [21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42,21,32,12,32,32,42],
        "Download":
                [12,32,123,123,21,23,44,55,66,77,55,44,23,11,15,27,99,29,100,23,31,53,23,43,12,32,123,123,21,23,44,55,66,77,55,44,23,11,15,27,99,29,100,23,31,53,23,43,12,32,123,123,21,23,44,55,66,77,55,44,23,11,15,27,99,29,100,23,31,53,23,43,12,32,123,123,21,23,44,55,66,77,55,44,23,11,15,27,99,29,100,23,31,53,23,43,12,32,123,123,21,23,44,55,66,77,55,44,23,11,15,27,99,29,100,23,31,53,23,43,12,32,123,123,21,23,44,55,66,77,55,44,23,11,15,27,99,29,100,23,31,53,23,43],
        "TimePoint":
                ["00:00", "00:10", "00:20", "00:30", "00:40", "00:50", "01:00", "01:10", "01:20", "01:30", "01:40", "01:50", "02:00", "02:10", "02:20", "02:30", "02:40", "02:50", "03:00", "03:10", "03:20", "03:30", "03:40", "03:50", "04:00", "04:10", "04:20", "04:30", "04:40", "04:50", "05:00", "05:10", "05:20", "05:30", "05:40", "05:50", "06:00", "06:10", "06:20", "06:30", "06:40", "06:50", "07:00", "07:10", "07:20", "07:30", "07:40", "07:50", "08:00", "08:10", "08:20", "08:30", "08:40", "08:50", "09:00", "09:10", "09:20", "09:30", "09:40", "09:50", "10:00", "10:10", "10:20", "10:30", "10:40", "10:50", "11:00", "11:10", "11:20", "11:30", "11:40", "11:50", "12:00", "12:10", "12:20", "12:30", "12:40", "12:50", "13:00", "13:10", "13:20", "13:30", "13:40", "13:50", "14:00", "14:10", "14:20", "14:30", "14:40", "14:50", "15:00", "15:10", "15:20", "15:30", "15:40", "15:50", "16:00", "16:10", "16:20", "16:30","16:40","16:50","17:00", "17:10", "17:20", "17:30", "17:40", "17:50", "18:00", "18:10", "18:20", "18:30", "18:40", "18:50", "19:00", "19:10", "19:20", "19:30", "19:40", "19:50", "20:00", "20:10", "20:20", "20:30", "20:40", "20:50", "21:00", "21:10", "21:20", "21:30", "21:40", "21:50", "22:00", "22:10", "22:20", "22:30", "22:40", "22:50", "23:00", "23:10", "23:20", "23:30", "23:40", "23:50", "24:00"]

    };


    var json = {
        "traffic_info": [
            [
                "1671",
                "0",
                "13:40:02"
            ],
            [
                "1216",
                "0",
                "13:40:03"
            ],
            [
                "1671",
                "0",
                "13:40:04"
            ],
            [
                "1216",
                "0",
                "13:40:05"
            ],
            [
                "1671",
                "0",
                "13:40:06"
            ],
            [
                "1216",
                "0",
                "13:40:07"
            ],
            [
                "1671",
                "0",
                "13:40:08"
            ],
            [
                "1216",
                "0",
                "13:40:09"
            ],
            [
                "1671",
                "0",
                "13:40:10"
            ],
            [
                "1216",
                "0",
                "13:40:11"
            ],
            [
                "1671",
                "0",
                "13:40:12"
            ],
            [
                "1216",
                "0",
                "13:40:13"
            ],
            [
                "1671",
                "0",
                "13:40:14"
            ],
            [
                "1216",
                "0",
                "13:40:15"
            ],
            [
                "1671",
                "0",
                "13:40:16"
            ],
            [
                "1216",
                "0",
                "13:40:17"
            ],
            [
                "1671",
                "0",
                "13:40:18"
            ],
            [
                "1216",
                "0",
                "13:40:19"
            ],
            [
                "1671",
                "0",
                "13:40:20"
            ],
            [
                "1216",
                "0",
                "13:40:21"
            ],
            [
                "1671",
                "0",
                "13:40:22"
            ],
            [
                "1216",
                "0",
                "13:40:23"
            ],
            [
                "1671",
                "0",
                "13:40:24"
            ],
            [
                "1216",
                "0",
                "13:40:25"
            ],
            [
                "1671",
                "0",
                "13:40:26"
            ],
            [
                "1216",
                "0",
                "13:40:27"
            ],
            [
                "1671",
                "0",
                "13:40:28"
            ],
            [
                "1216",
                "0",
                "13:40:29"
            ],
            [
                "1671",
                "0",
                "13:40:30"
            ],
            [
                "1216",
                "0",
                "13:40:31"
            ],
            [
                "1671",
                "0",
                "13:40:32"
            ],
            [
                "1216",
                "0",
                "13:40:33"
            ],
            [
                "1671",
                "0",
                "13:40:34"
            ],
            [
                "1216",
                "0",
                "13:40:35"
            ],
            [
                "1671",
                "0",
                "13:40:36"
            ],
            [
                "1216",
                "0",
                "13:40:37"
            ],
            [
                "1671",
                "0",
                "13:40:38"
            ],
            [
                "1216",
                "0",
                "13:40:39"
            ],
            [
                "1671",
                "0",
                "13:40:40"
            ],
            [
                "1216",
                "0",
                "13:40:41"
            ],
            [
                "1671",
                "0",
                "13:40:42"
            ],
            [
                "1216",
                "0",
                "13:40:43"
            ],
            [
                "1671",
                "0",
                "13:40:44"
            ],
            [
                "1216",
                "0",
                "13:40:45"
            ],
            [
                "1671",
                "0",
                "13:40:46"
            ],
            [
                "1216",
                "0",
                "13:40:47"
            ],
            [
                "1671",
                "0",
                "13:40:48"
            ],
            [
                "1216",
                "0",
                "13:40:49"
            ],
            [
                "1671",
                "0",
                "13:40:50"
            ],
            [
                "1216",
                "0",
                "13:40:51"
            ],
            [
                "1671",
                "0",
                "13:40:52"
            ],
            [
                "1216",
                "0",
                "13:40:53"
            ],
            [
                "1671",
                "0",
                "13:40:54"
            ],
            [
                "1216",
                "0",
                "13:40:55"
            ],
            [
                "1671",
                "0",
                "13:40:56"
            ],
            [
                "1216",
                "0",
                "13:40:57"
            ],
            [
                "1671",
                "0",
                "13:40:58"
            ],
            [
                "1216",
                "0",
                "13:40:59"
            ],
            [
                "1671",
                "0",
                "13:41:00"
            ],
            [
                "1216",
                "0",
                "13:41:01"
            ]
        ]
    };




    function  doData() {
        $.ajax({
            type: "GET",
            url: "http://localhost:63342/ECharts/test/GetData",
            success: function (data) {
                var json_data = JSON.parse(data);
                //console.log(json_data);


                initCharts(json_data);
            }
        })
    }
    var upload_data = [],
            download_data = [],
            time_point = [];
    function  initCharts(json_data) {

        var traffic_info = json_data.traffic_info;


        if(traffic_info.length > 0){
            for (var i=0; i<traffic_info.length; i++){

                if(upload_data.length > 10){
                    upload_data.shift();
                    download_data.shift();
                    time_point.shift();
                }

                upload_data.push(traffic_info[i][0] * 8);
                download_data.push(traffic_info[i][1] * 8);
                time_point.push(traffic_info[i][2]);
            }
        }

        var wrap_obj = document.getElementById("wrap");
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(wrap_obj);
        var option = {
            tooltip: {
                trigger: 'axis',
                backgroundColor: 'rgba(10, 36, 51, 0.8)',
                axisPointer: {
                    type: 'line',
                    lineStyle: {
                        color: '#00629b',
                        width: 1,
                        type: 'dashed'
                    }
                },
                textStyle: {
                    fontFamily: '"rutledgeregular", sans-serif'
                }
            },
            grid: {
                left: "15%",
                right: "2%",
                containLabel: true
            },
            xAxis: {
                type: "category",
                boundaryGap: false,
                data: time_point,
                axisLine: { // 坐标轴轴线相关设置。
                    lineStyle: {
                        color: '#d8d8d9',
                        width: 2,
                        type: 'dashed'
                    }
                },
                splitLine: { // 坐标轴在 grid 区域中的分隔线。
                    lineStyle: {
                        color: '#d8d8d9',
                        width: 2,
                        type: 'dashed'
                    }
                },
                axisLabel: { // 坐标轴刻度标签的相关设置。
                    textStyle: {
                        fontFamily: '"rutledgeregular", sans-serif',
                        fontSize: 12,
                        color: '#3f3f45'
                    }
                }
            },
            yAxis: {
                type: "value",
                axisLine: {
                    lineStyle: {
                        color: '#d8d8d9',
                        width: 2,
                        type: 'dashed'
                    }
                },
                splitLine: {
                    lineStyle: {
                        color: '#d8d8d9',
                        width: 2,
                        type: 'dashed'
                    }
                },
                axisLabel: {
                    // Add by Emil.You 2016-2-19 start
                    // 修改单位缺失的问题
                    formatter: '{value} Mb/s',
                    // Add by Emil.You 2016-2-19 end
                    textStyle: {
                        fontFamily: '"rutledgeregular", sans-serif',
                        fontSize: 12,
                        color: '#3f3f45'
                    }
                }
            },
            series: function() {
                var wrap = [];
                // add the hover show
                var markPoint = {
                    symbolSize: [80,80],
                    itemStyle: {
                        normal: {
                            label: {
                                textStyle:{
                                    fontFamily: '"rutledgeregular", sans-serif'
                                }
                            }
                        }
                    },
                    data: [{
                        type: "max",
                        name: "max"
                    }, {
                        type: "min",
                        name: "min"
                    }]
                };
                // add average line
                var markLine = {
                    itemStyle: {
                        normal: {
                            label: {
                                textStyle:{
                                    fontFamily: '"rutledgeregular", sans-serif'
                                }
                            }
                        }
                    }
                };
                var upload = {},
                        download = {};
                upload.name = "Upload";
                upload.type = 'line';
                upload.markPoint = markPoint;
                upload.markLine = markLine;
                upload.data = upload_data;
                upload.itemStyle = {
                    normal:{
                        color: "rgb(143, 195, 31)"
                    }
                };
                download.name = "Download";
                download.type = 'line';
                download.markPoint = markPoint;
                download.markLine = markLine;
                download.data = download_data;
                download.itemStyle = {
                    normal:{
                        color: "rgb(5, 154, 229)"
                    }
                };
                wrap.push(upload);
                wrap.push(download);
                return wrap;
            }()
        };

        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
    }
    doData();
    setInterval(doData, 5000);

</script>
</body>
</html>